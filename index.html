<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Infinity Track</title>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#DEBA52;
      --bg:#000;
      --fg:#F5F5F5;
      --fg-dim:#8E8E8E;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      display:flex;
      justify-content:center;
      align-items:center;
      height:100vh;
      background:var(--bg);
      color:var(--fg);
      font-family:'Poppins',sans-serif;
    }
    svg path.track{
      stroke:var(--fg-dim);
      stroke-width:.6;
      fill:none;
    }
    svg .trail{
      stroke:var(--accent);
      stroke-width:2;
      fill:none;
      stroke-linecap:round;
      animation:trail-anim var(--dur) linear infinite;
      stroke-dasharray:.15 .85;
      stroke-dashoffset:1;
      pathLength:1;
    }
    @keyframes trail-anim{
      to{stroke-dashoffset:-1;}
    }
    .dot{
      fill:var(--accent);
      filter:drop-shadow(0 0 4px var(--accent));
    }
  </style>
</head>
<body>
  <svg width="400" height="240" viewBox="0 0 400 240" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <defs>
      <!-- Infinity path definition (flat figure-8) -->
      <path id="infinityPath" d="M 100 120 C 100 60 200 60 200 120 S 300 180 300 120 S 200 60 200 120 S 100 180 100 120"/>
    </defs>

    <!-- Track (sideâ€‘view perspective) -->
    <use href="#infinityPath" class="track" transform="translate(0,-10) scale(1,0.6) rotate(-15 200 120)" />

    <!-- Glowing trail that loops forever -->
    <use href="#infinityPath" class="trail" style="--dur:6s" transform="translate(0,-10) scale(1,0.6) rotate(-15 200 120)" />

    <!-- Moving dots -->
    <circle id="p1" class="dot" r="4"/>
    <circle id="p2" class="dot" r="4"/>
    <circle id="p3" class="dot" r="4"/>

    <script type="application/ecmascript"><![CDATA[
      // Clone the transformed path to measure the correct length
      const original = document.getElementById('infinityPath');
      const clone = original.cloneNode();
      const trans = 'translate(0,-10) scale(1,0.6) rotate(-15 200 120)';
      clone.setAttribute('transform', trans);
      clone.setAttribute('visibility', 'hidden');
      clone.setAttribute('fill', 'none');
      document.querySelector('svg').appendChild(clone);
      const len = clone.getTotalLength();

      // Points with randomised speed
      const pts = [
        {el:document.getElementById('p1'), t:Math.random(), speed:Math.random()*0.002+0.001},
        {el:document.getElementById('p2'), t:Math.random(), speed:Math.random()*0.002+0.001},
        {el:document.getElementById('p3'), t:Math.random(), speed:Math.random()*0.002+0.001}
      ];

      function randomiseSpeeds(){
        for(const p of pts){
          p.speed = Math.random()*0.002+0.001;
        }
      }
      setInterval(randomiseSpeeds,5000);

      function tick(){
        for(const p of pts){
          p.t = (p.t + p.speed) % 1;
          const pos = clone.getPointAtLength(p.t * len);
          p.el.setAttribute('cx', pos.x);
          p.el.setAttribute('cy', pos.y);
        }
        requestAnimationFrame(tick);
      }
      tick();
    ]]></script>
  </svg>
</body>
</html>
